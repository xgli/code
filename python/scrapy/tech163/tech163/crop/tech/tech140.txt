揭秘 Magic   Leap 技术 背景 ： 混合 现实 前景 如何 
Magic   Leap   因为 阿里 投资 的 传闻 和 一 周 前 的 概念 视频 在 近期 可谓 引 火 上身 ， 短短 几 天 时间 内 ， 从 概念 视频 经 微 博 营销 号 之 手 火 遍 社交 网络 ， 到 一 如 过街老鼠 一般 人 人 唾弃 。 要 知道 ， Magic   Leap   在   2014   年   10   月 获得 了 来自   Google 、 高 通 、 传奇 娱乐 、 Thomas   Tull 、 KKR 、 Vulcan   Capital 、 Kleiner   Perkins   Caufield  & amp ;   Byers 、 Andreessen   Horowitz   和  Obvious   Ventures  等 机构 和 投资人 共计  5.42  亿 美元 的   B  轮 投资 ， 融资 完成 后 ， 前   Google   Android   及   Chrome   团队 负责人 、 现   Google   公司   CEO   Sundar   Pichai   加入   Magic   Leap   的 董事会 。 的确 ， 不 像 近期 热门 的 微 软   HoloLens ， Magic   Leap   作为 下一代 内容 呈现 和 交互 平台 混合 现实 （ Mixed  Reality ） 领域 的 竞争 者 ， 至今 并 没有 实 机   demo   演示 ， 仅 有 出自 官方   YouTube   账号 的 两 段 视频 。 但 这 并 不 妨碍 我们 从 这家 公司 近年来 申请 的 专利 和 引进 的 专家 来 分析 他们 的 技术 方向 。 目前 为止 ， 无论是 虚拟 现实 （ VR ） 应用 还 是 增强 现实 （ AR ） 应用 ， 图像 本身 的 路径 基本上 都 经历 这样 的 过程 ： 光   -   镜头   -   传感器   -   数字化   CV   算法   -   LCD/LED   显示器 ， 最终 我们 看到 的   AR/VR   内容 都 是 通过   LCD/LED   显示器 传入 人 眼 。 而   LCD/LED   本身 在 耗电 、 重量 、 体积 等 方面 存在 缺陷 ， 是   AR/VR   用户 体验 发展 的 主要 瓶颈 之一 。 而   Magic   Leap   拥有 一 种 名 为   Fiber   Optic   Projector   的 核心 技术 ， 这种   “ 投影仪 ”   与 传统 意义 上 的 投影 相比 ， 尺寸 更 小 ， 功 耗 更 低 ， 可以 通过 一 根 直径   1   毫米 长   9   毫米 的 光纤 投 出 几 英寸 彩色 图像 。 谈及   Fiber   Optic   Projector   的 原理 ， 我们 就要 从 已经 加盟 了   Magic   Leap   的 华盛顿 大学   Eric   Seibel   教授 说 起 。 Prof.  Eric   Seibel   致力 于 研究 内窥镜 已 有 数十 载 ， 他 的 研究 团队 曾 在   2013   年 公开 展示 一 种 直径   1   毫米 、 基于 光纤 扫描 的 内窥镜 。 相比 原来 动辄 几 厘米 直径 的 内窥镜 而言 ， 这 是 一 种 变革 性 的 进步 。 它 的 原理 简单 来说 就 如 下 图   ——   内窥镜 由 基于   MEMS   的 驱动器   Actuator 、 单 光纤 、 镜头 组 、 直径   1   毫米 的 套管 组成 。 当 内窥镜 工作 时 ， 微电脑 通过 控制 多 个 驱动器 ， 精确 控制 光纤 末端 的 扫描 路径 ， 通过 画 直径 由 小 变 大 的 同心圆 来 完成 整个 画面 的 图像 扫描 ， 再 将 数据 回 传 给 电脑 合成 图像 。 Magic   Leap   的  Fiber   Optic   Projector  和 这个 内窥镜 工作 原理 类似 ， 只是 光纤 末端 并 不 是 用来 采集 图像 ， 而是 发出 显示 图像 的 光线 ， 通过 驱动器 足够 快速 的 扫描 ， 让 镜头 末端 得以 逐个 投 出 图像 。 这个 原理 听 起来 简单 ， 要 在 工程 上 实现 是 非常 了不起 的 。 上面 我们 提 到 过 ， 这种 基于 光纤 扫描 的 显示 设备 有功 耗 低 、 重量 轻 、 体积 小 等 优点 ， 而且 可以 通过 多 个 光纤 末端 阵列 堆 叠 的 方式 来 实现   FOV   ( Field   of   View )   显示 。 而 对于 这种 光纤 扫描 投影仪 的 画质 ， 想必 大家 也 不必 过于 担心 。 通过   Google   Patent   的 检索 ， 我们 发现 这家 公司 已经 在 为 美国 国防部 研制 分辨率 达到   4K   级别 的 光纤 扫描 显示 设备 。 说 完 光学 呈 像 原理 ， 我们 再 来说 说   Magic   Leap   在 计算机 视觉 技术 （ Computer   Vision ， 以下 简称   CV ） 方面 的 成就 。 上 图 来自   Magic   Leap   近期 的 宣传 视频 ， 这些 都 是   CG   特效 ， 并且   Magic   Leap   自己 也 承认 视频 里 的 都 是 特效 。 这样 用于 表达   idea   的 概念 视频 在 硅谷 公司 里 很 常见 ， 并 不 值得 指 摘 。 接 下来 ， 我们 重点 针对 上 图 里 的 这 两 组 进行 分析 。 一 如   HoloLens   在 去年   10   月 首 次 亮相 展示 的 宣传 视频 ， 纵然   Magic   Leap   在 视频 里 明确 标注 了   " No   special   effets   or   compositing " ， 很 多 看 客 还是 倾向 于 对 它们 持 怀疑 态度 。 不过 ， 要 真正 在 技术 和 学术 上 讨论   Magic   Leap   在   CV   和   CG   技术 领域 展现 的 成果 和 远景 ， 就 需要 建立 两 个 假设 ： 第一 ， 视频 实在   Magic   Leap   设备 上 使用 他们 的 原 创 技术 生成 的 ， 即 他们 没有 说谎 ； 第二 ， 视频 是 通过 他们 的 设备 实时 采集 、 处理 并 展示 的 ， 即 从 外界 感知 环境 数据 到 获得   AR   效果 图像 的 整体 时间 在   33ms ~ 67ms   这个 时间 范围 内 。 第一 张 图 中 ， 躲 在 桌 下 的 小 机器人 被 发现 后 ， 惊慌失措 片刻 向 摄像机 打 了 个 招呼 。 过程 中 摄像机 持续 在 移动 ， 中间 桌子 对 小 机器人 发生 了 部分 遮挡 。 在 这个 场景 里 ： 首先 是 三维 信息 感知 ： 计算机 必须 通过 传感器 感知 三维 环境 信息 ， 这 个 传感器 可以 是 普通  RGB  摄像头 ， 也 可以 是  TOF  或者 结构 光 深度 摄像头 ， 但是 选择 不同 的 摄像头 也 决定 了 接下来 算法 的 复杂 程度 。 第二 步 是 三维 场景 重构 ， 这 也 是 最 重要 的 一 步 ， 需要 通过 所 获得 的 环境 信息 实时 对 场景 进行 三维 重构 。 这里 就 用 到 了 大家 最近 在  AR  领域 反复 提及 的  SLAM  算法 ， 该 算法 在 实时 构建 三维 场景 的 同时 ， 能够 准确 地 定位 拍摄 相机 （ 或 拍摄 者 ） 的 位置 。 有 了 三维 环境 和 位置 这 两 个 信息 ， 接 下来 的 图形 渲染 工作 才 能 进行 。 目前 对于  RGBD  来 构造 三维 场景 的  SLAM  算法 相对 比较 多 ， 最 钟 明 的 当 属 微 软 英国 剑桥 研究院 和 帝国 理 工  Andrew  Davison  教授 （ 接下来 会 多次 提到 这 位 教授 的 名字 ） 共同 开发 的  KinectFusion ； 如果 用  RGB  摄像头 的话 ， 也 有  LSD  Semi - dense  SLAM  和  DTAM  等 算法 来 获得 相对 丰富 的 三维 场景 点 云 信息 。 Kinect   Fusion   重构 效果 LSD   Semi - dense   SLAM   重构 效果 DTAM   重构 效果 其中   DTAM   也 是 刚才 提 到 过 那 位   Andrew   Davison   教授 的 重要 研究 工作 。 第三 步 ， 三维 场景 识别 ： 当 我们 通过 第二 步 获得 了 丰富 的 三维 场景 信息 后 ， 接 下来 需要 让 计算机 理解 三维 场景 ， 即 让 计算机 认知 什么 是 地板 ， 什么 是 天花板 ， 什么 是 桌子 ， 是 一 张 什么 桌子 ， 桌子 的 材质 是 什么 ？ 目前 在 研究 领域 ， 3D  场景 与 物体 的 识别 才 属于 起步 阶段 ， 受到 数据 集 和 采集 方式 ， 目前 并 没有 显著 的 突破 。 因此 在  Magic  Leap  放出 的  demo  视频 里 ， 他们 巧妙 地 只 使用 了 桌子 ， 一些 可以 有效 识别 的 物体 。 这 方面 的 研究 工作 ， 领先 者 又 是 那位  Andrew  Davison  教授 ， 他 领导 的 实验室 在  CVPR2013  会议 上 提出 的  SLAM++  算法 ， 可以 通过  RGBD  摄像头 进行  SLAM  的 同时 进行 实时 物体 识别 ， 并 完成 物体 的 物理 建 模 。 SALM++   的 三维 重构 和 识别 效果 第四 步 ， 物理 建 模 与 仿真 ： 在 识别 出 三维 物体 之后 ， 虚拟 物件 （ 小 机器人 ） 需要 和 物件 发生 交互 （ 例如 ： 碰撞 ） ， 则 需要 对 三维 物体 的 材质 进行 识别 。 由于  demo  中 展示 的 是 刚体 碰撞 效果 ， 仿真 上相 对 容易 。 那 我们 推广 一 下 ， 如果 是 实时 的 流体 材质 仿真 ， 就 需要 提到  CG  研究 领域 的  physically  based  rendering 。 该 技术 通过 建立 物体 的 物理 数学 模型 ， 在 计算机 中 仿真 交互 中 物体 的 物理 变化 。 如果 有 一 天  Magic  Leap  真 要 实现 概念 视频 中 鲸鱼 的 效果 ， 大量 的 水滴 溅 射 效果 在 移动 设备 上 的 实时 计算 仿真 也 会 是 很 大 的 工程 门槛 。 五 ， 实时  CG  图像 渲染 ： 在 完成 了 所有 呈现 效果 的 仿真 计算 之后 ， 便 是 将  AR  效果 实时 渲染 出来 ， 进而 投射 在 显示 设备 上 。 这 是 个 相对 成熟 的 工程 问题 ， 也 有 很多 工程师 可以 回答 这个 问题 ， 这里 不再 赘述 。 第二 个   demo   更 多 展示 的 是   CG   图像 的 视觉 效果 和 分辨率 ， 而   AR   的 特性 通过 现 有 很多   AR   开源 包 都 能够 实现 ， 更 多 是 硬件 工程 上 的 工作 ， 不 属于 这个 章节 的 讨论 范畴 。 通过 上面 这 五 步 ， 我们 可以 得到 一个 流水线 程序 。 从 计算机 工程 上 来说 ， 这个 流水线 覆盖 了 传感器 信号 处理 、 三维 重构 、 三维 物体 识别 、 计算机 图形 学 四 个 领域 。 在   Magic   Leap   所 展示 出来 的   demo   中 都 体现 了 现在 计算机 科学 领域 的 最新 研究 成果 ， 而 它 所 体现 出来 的 流畅 性 和 继承性 ， 也 代表 了 目前 计算机 工程 领域 的 最高 工业 水平 。 作为 计算机 科学 的 研究 人员 和 计算机 工程 的 从业 人员 ， 我 都 愿意 为 这些 进步 拍手 点 赞 。 当然 ， 这 一切 都 建立 在 本 章 开头 的 两 个 假设 上 。 虽然 近期 国内 技术 型 创业 公司 环境 显得 浮躁 ， 但 怀疑   Magic   Leap   B   轮 资方 中 任意 一 方 的   DD   （ 尽职 调查 ） 能力 都 不 算 明智 ， 希望 这 篇 文章 能 作为 一个 引子 ， 大家 重新 冷静 考虑 国内外 技术 的 差距 和 相对 优势 。 另外 ， 我 愿意 相信 现在   Magic   Leap   设备 的 尺寸 非常 大 ， 稍稍 分析 一下 上面 这些 算法 的 计算 量 ， 就 至少 需要 两 台 配备 顶级   GPU   的 顶 配 台式 机 。 即时   Magic   Leap   自己 开发 了 全 套   FPGA   （ 短 时间 内   SoC   的 可能性 不 大 ） 实现 ， 其 发热量 和 功 耗 也 暂时 无法 支撑 它 成为 一 款 便 携 设备 。 但 任何 一 项 技术 在 理论 上 得到 突破 后 都 需要 漫长 的 工程 等待 ， 何况 高 通 参 投 了   Magic   Leap 。 至于   HoloLens ， 微 软 现阶段 还 没有 什么 担心 的 余地 ， 目前   Magic   Leap   的 核心 技术 微 软 几乎 都 有 ， Andrew   Davison   几乎 所有 重要 论文 都 是 和 微 软 剑桥 研究院 合作 的 ， 本来 相对 偏 弱 的   CG   技术 也 通过 收购   Intel   手中 的   Havok   得到 补 强 。 加上 强大 的 开发 者 社区 ， 未来 市场 里 一定 少不了 微 软 的 位置 。 